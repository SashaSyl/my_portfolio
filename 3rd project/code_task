-- Compare the indicators of both tables
SELECT *
FROM abtest.control_group as c
JOIN abtest.test_group as t
ON c.date = t.date
ORDER BY c.date
;

-- What percentage of add-to-cart actions out of total reach in both tables
SELECT 
  c.reach, 
  c.add_cart, 
  ROUND((c.add_cart/c.reach)*100,2) as proc_c,t.reach, 
  t.add_cart, 
  ROUND((t.add_cart/t.reach)*100,2) as proc_t
FROM abtest.control_group as c
JOIN abtest.test_group as t
ON c.date = t.date
ORDER BY c.date
;

-- Percentage of unique views (reach) from total impressions across both tables
SELECT 
  c.impressions, 
  c.reach, 
  ROUND(( c.impressions/c.reach)*100,2) as proc_c, 
  t.impressions, 
  t.reach,
  ROUND(( t.impressions/t.reach)*100,2) as proc_t
FROM abtest.control_group as c
JOIN abtest.test_group as t
ON c.date = t.date
ORDER BY c.date
;

-- Buyers per dollar spent across both tables
SELECT 
  c.add_cart, 
  c.spend, 
  ROUND(( c.add_cart/c.spend),2)as proc_c, 
  t.add_cart, 
  t.spend,
  ROUND(( t.add_cart/t.spend),2)as proc_t
FROM abtest.control_group as c
JOIN abtest.test_group as t
ON c.date = t.date
ORDER BY c.date
;

